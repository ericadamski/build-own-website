"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),q=require("q"),path=require("path"),fs=require("fs"),needle=require("needle"),_=require("underscore"),URL="https://medium.com/@",blogTemplate=_.template(fs.readFileSync(path.join(__dirname,"..","..","..","views","blog.html")).toString());module.exports=function(){function e(r){_classCallCheck(this,e),this.username=r}return _createClass(e,[{key:"latest",value:function(){var e=q.defer();return needle.get(""+URL+this.username+"/latest",function(r,t){if(r)return e.reject(r);var n=require("jsdom").env,i=t.body;n(i,function(r,t){r&&e.reject(r);var n=require("jquery")(t);n(".postMeta-previewFooterActions").remove(),e.resolve(blogTemplate({posts:_.keys(n(".postItem")).filter(function(e){return!isNaN(parseInt(e))}).map(function(e){return'\n                <div class="medium-post">\n                  '+n(n(".postItem")[e]).html()+"\n                </div>"}).reduce(function(e,r){return e+r})}))})}),e.promise}}]),e}();